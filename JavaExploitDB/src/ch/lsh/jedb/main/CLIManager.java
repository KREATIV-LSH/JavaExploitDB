package ch.lsh.jedb.main;

import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

import ch.lsh.jedb.command.CommandManager;
import ch.lsh.jedb.exploit.ExploitManager;

public class CLIManager {

	public static boolean running = true;
	public static CommandManager cmdManager;
	public static ExploitManager expManager;

	public static void startShell() throws IOException {
		BufferedReader bf = new BufferedReader(new InputStreamReader(System.in));
		String input;
		cmdManager  = new CommandManager();
		expManager = new ExploitManager();
		while (running) {
			System.out.print(formatCommandLine(cmdManager.getRunningModule()));
			input = bf.readLine();
			if (input.contains(" ")) {
				cmdManager.execute(input.split(" ")[0], input.split(" ", 2)[1]);
			} else {
				cmdManager.execute(input, "");
			}
		}
	}

	public static String formatCommandLine(String module) {
		StringBuilder sb = new StringBuilder();

		// Name
		sb.append("JavaExploitDB");
		// Seperator
		sb.append("/");
		// Module
		if (module != null) {
			sb.append(module);
		}
		// end
		sb.append(": ");

		return sb.toString();
	}

}
