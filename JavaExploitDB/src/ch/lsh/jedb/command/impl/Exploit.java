package ch.lsh.jedb.command.impl;

import java.util.Arrays;

import ch.lsh.jedb.command.Command;
import ch.lsh.jedb.main.CLIManager;

public class Exploit extends Command {

	public Exploit() {
		super("exploit", "acces to all commands for exploits", "exploit help");
	}

	@Override
	public void execute(String args1) {
		String[] args = args1.split(" ");
		if (args1.length() > 0) {
			performAction(args);
		} else {
			System.err.println("Try 'exploit help' for help!");
		}
	}
	
	private static void performAction(String[] args) {
		String action = args[0].toLowerCase();
		String params = args.length > 1 ? Arrays.toString(Arrays.copyOfRange(args, 1, args.length)).replace("[", "").replace("]", "").replace(",", "") : "";
//		System.out.println("Action: " + action);
		System.out.println("Parameters: " + params + "\n");
		
		switch(action) {
			case "list":
				System.out.println("Name:\t\tDescription:");
				for(ch.lsh.jedb.exploit.Exploit exp : CLIManager.expManager.getExploits()) {
					System.out.println(exp.getName() + "\t\t" + exp.getDesc());
				}
				break;
			default:
				System.err.println("Command 'exploit " + action + "' not recognized!\nTry 'exploit help' for help");
		}
	}

}
